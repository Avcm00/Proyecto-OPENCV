<!-- templates/informe.html -->
{% extends 'base.html' %}

{% block content %}
<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    
    <!-- Header -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold text-gray-900">Informe Estadístico</h1>
      <p class="text-gray-600 mt-2">Análisis de perfiles y recomendaciones</p>
    </div>

    <!-- Gráfico: Tipos de Rostro -->
    <div class="bg-white rounded-lg shadow-sm p-6 mb-8 border-l-4 border-yellow-400">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Cantidad de Perfiles por Tipo de Rostro</h2>
      <canvas id="faceShapeChart" width="400" height="200"></canvas>
    </div>

    <!-- Gráfico: Top 3 Cortes de Cabello -->
    <div class="bg-white rounded-lg shadow-sm p-6 mb-8 border-l-4 border-yellow-400">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Top 3 Cortes de Cabello Más Recomendados</h2>
      <canvas id="topHaircutsChart" width="400" height="200"></canvas>
    </div>

    <!-- Gráfico: Top 3 Barbas -->
    <div class="bg-white rounded-lg shadow-sm p-6 mb-8 border-l-4 border-yellow-400">
      <h2 class="text-xl font-semibold text-gray-900 mb-4">Top 3 Barbas Más Recomendadas</h2>
      <canvas id="topBeardsChart" width="400" height="200"></canvas>
    </div>

  </div>
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Datos pasados desde la vista
  const faceShapeData = {{ face_shape_counts|safe }};
  const topHaircutsData = {{ top_haircuts|safe }};
  const topBeardsData = {{ top_beards|safe }};

  // Gráfico de Tipos de Rostro
  const faceShapeCtx = document.getElementById('faceShapeChart').getContext('2d');
  new Chart(faceShapeCtx, {
    type: 'bar',
    data: {
      labels: Object.keys(faceShapeData),
      datasets: [{
        label: 'Cantidad de Perfiles',
        data: Object.values(faceShapeData),
        backgroundColor: 'rgba(255, 206, 86, 0.6)',
        borderColor: 'rgba(255, 206, 86, 1)',
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });

  // Gráfico de Top Cortes de Cabello
  const topHaircutsCtx = document.getElementById('topHaircutsChart').getContext('2d');
  new Chart(topHaircutsCtx, {
    type: 'bar',
    data: {
      labels: topHaircutsData.map(item => item.id),
      datasets: [{
        label: 'Cantidad de Recomendaciones',
        data: topHaircutsData.map(item => item.count),
        backgroundColor: 'rgba(54, 162, 235, 0.6)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });

  // Gráfico de Top Barbas
  const topBeardsCtx = document.getElementById('topBeardsChart').getContext('2d');
  new Chart(topBeardsCtx, {
    type: 'bar',
    data: {
      labels: topBeardsData.map(item => item.id),
      datasets: [{
        label: 'Cantidad de Recomendaciones',
        data: topBeardsData.map(item => item.count),
        backgroundColor: 'rgba(75, 192, 192, 0.6)',
        borderColor: 'rgba(75, 192, 192, 1)',
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });
</script>
{% endblock %}